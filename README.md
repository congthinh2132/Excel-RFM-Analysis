# Excel RFM Analysis
## I. Introduction:
### 1. About RFM Analysis:
RFM (Recency, Frequency, Monetary) analysis is a proven marketing model for behavior-based customer segmentation. It groups customers based on their transaction history:
- **Recency:** Measures How recently a customer has made a purchase
- **Frequency:** How often a customer makes a purchase
- **Monetary value:** How much money a customer spends on purchases

RFM analysis numerically ranks a customer in each of these three categories, generally on a scale of 1 to 5 (the higher the number, the better the result). The “best” customer would receive a top score in every category.

These three RFM factors can be used to reasonably predict how likely (or unlikely) it is that a customer will do business again with a firm or, in the case of a charitable organization, make another donation.
### 2. Business Questions:
- The Marketing Department aims to classify customer segments to tailor marketing programs for each group effectively.
- The Marketing Director has proposed utilizing the RFM model in Excel to segment customers. 
- This approach will support launching marketing campaigns to express gratitude to loyal customers and nurture potential customers into becoming long-term supporters of the company.

### 3. Dataset:
Dataset includes 4 different related tables including: transaction information, products information, customers information, returned orders of customers purchasing products from 2014 to 2017 and RFM classification
- Transaction information: 
![image](https://github.com/user-attachments/assets/32b4c9a5-b674-4caf-b926-aa5dbf09b375)
- Products information:
![image](https://github.com/user-attachments/assets/d9906e18-96e1-4f6a-a98f-efdc55fe360f)
- Customers information:
![image](https://github.com/user-attachments/assets/44aa4ff3-c9dd-4d1c-aece-276fa3966e31)
- Returned orders: We have to filter orders that were not returned before RFM analysis.
![image](https://github.com/user-attachments/assets/48ad4743-88fc-4cd3-8dac-d5f0310ee3a5)
- RFM classification: We need to split each RFM score to single rows
![image](https://github.com/user-attachments/assets/1c7ba0a6-9da7-4d6d-a464-4dd17e06ed25)

Dataset is available in [kaggle](https://www.kaggle.com/datasets/vivek468/superstore-dataset-final/data)

## II.  Data Preparation:
### 1. Cleaning the data:
- Remove duplicate rows: Any duplicate rows in the dataset should be identified and removed to ensure the data is clean and accurate for further analysis. This step eliminates redundant entries that could distort results or calculations.
### 2. Transforming the data:
- Prepare a consolidated orders table: Since transactions are currently split by each product within the same order, we need to aggregate the data. This transformation involves summarizing the information for each order by combining rows based on the Order ID.
- Key steps include:
  - Grouping the data by Order ID.
  - Summing up the monetary values (e.g., total sales or revenue).
  - Counting the number of items (or rows) per order, if needed.
  - Ensuring the data is structured such that each row represents one unique order.

![image](https://github.com/user-attachments/assets/46a97f41-af61-4cb0-8231-36aa36eba371)

### 3. Calculating the RFM Analysis:
RFM Analysis involves calculating the following metrics for each customer:
- Recency (R): The time since the customer's last purchase.
  - How to calculate: Measure the number of days between the most recent transaction date and a reference date (e.g., the date of analysis).
Formula: Recency = Reference Date - Last Purchase Date
- Frequency (F): The average number of transactions per year the customer has been with your business.
  - How to calculate: Count the total number of transactions for a customer, then divide it by the number of years they’ve been with your company.
  - Formula: Frequency = Total Transactions / Years with Us
    - To calculate the number of years: Years with Us = (Reference Date - First Purchase Date) / 365
- Monetary (M): The total revenue generated by the customer.
  - How to calculate: Sum the monetary value of all transactions for each customer.
  - Formula: Monetary = Sum of Order Amounts

![image](https://github.com/user-attachments/assets/05cff05c-a60b-4bcd-864d-7446d82e2791)

## III. Data Visualization:
- RFM Analysis:

![image](https://github.com/user-attachments/assets/fa3a570d-8825-417a-8a00-cc013da18639)
![image](https://github.com/user-attachments/assets/2101ef5a-8a6a-4abf-9dcd-df33c1887e58)
![image](https://github.com/user-attachments/assets/1c0fa50d-b8be-4ac5-a1ac-cd9878156c77)
![image](https://github.com/user-attachments/assets/7cb907a4-5a2a-49fc-8b3e-cf95d3ff6469)

- At risk:

![image](https://github.com/user-attachments/assets/5a62df83-9673-4702-95e7-5ad3c811be6f)
![image](https://github.com/user-attachments/assets/cf990434-997d-4f2a-92a8-e9dd2287ac79)
![image](https://github.com/user-attachments/assets/4e802515-ca9f-46bd-8ab6-2d0316f3ea7a)


- Potential Customers:

![image](https://github.com/user-attachments/assets/aa3cff06-f1bc-4ba3-93d3-e4b95c6fda71)
![image](https://github.com/user-attachments/assets/27ea9aa1-97f4-4a25-b04c-4499ca7f4470)
![image](https://github.com/user-attachments/assets/62be1821-b824-4bdf-b2ca-2abf604b50dc)



## IV. Insights:
### 1. Recency, Frequency and Monetary:
- As a retailer, Superstore should prioritize Recency and Frequency over Monetary since loyal customers in retail often make frequent purchases throughout the year, even at lower Average Transaction Sizes. However, the current Recency and Frequency metrics do not show many positive signs.
- Frequency: The mean is 2.08 transactions/year, which is quite low for a retail company. This indicates that customer loyalty is not high, as customers make purchases only about twice a year on average.
- Recency: The mean is approximately 148.8 days, while the median is 77 days. This difference highlights the presence of many customers with high Recency values. The larger this metric, the greater the likelihood of customer churn.
### 2. RFM Segments:
- Potential Loyalist has the largest proportion of customers, accounting for 16% of the total customer base.
- Negative Segments such as Hibernating Customers and Lost Customers, also represent a notable proportion, at 12% and 9%, respectively. However, these two groups account for less than 7% of revenue
- Positive segments like Champions and Loyal Customers comprise 11% and 9% of the customer base, indicating a relatively small share of highly engaged and loyal customers.
- Potential Loyalist has the largest proportion, but its revenue is only 9%. On the other side, At Risk segment accounting for 21%

=> In this marketing strategy, SuperStore should focus on converting Potential Loyalists into Loyal customers and Champions. Additionally, there should be a strategy in place to reconnect with customers in the At-Risk segment.
### 3. Potential Loyalist and At Risk segments:
#### 3.1 Potential Loyalist:
- The revenue in 2017 deceased from 155.160$ to 111.242$ and the average value of each orders decreased by 16.53% either(from 644$ to 537$)
- In two categories Furniture and Technology, we can be easy to see that the average value of each orders decreased 21% from (from 264$ to 208$) and 25% ( from 280$ to 209$)
- The numbers of orders increased 

#### 3.2 At Risk:
- 
## V. Recommendations:



